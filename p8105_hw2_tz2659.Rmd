---
title: "p8105_hw2_tz2659"
author: "Tracy Zhu"
date: "2024-10-02"
output: html_document
---

```{r}
file_path <- "E:/Tracy/fall 2024/P8105 Data Science/p8105_hw2_tz2659/"
options(scipen=999) # Cancel scientific notation when describing dataset
```


## Problem 1
```{r}
library(readr)
library(dplyr)
nyc_subway_data <- read_csv("NYC_Transit_Subway_Entrance_And_Exit_Data.csv")
```

### Data overview
```{r}
n_rows <- nrow(nyc_subway_data)
n_cols <- ncol(nyc_subway_data)
head(nyc_subway_data)
n_rows
n_cols
```
### Data cleaning
```{r}
# Select columns
cleaned_data <- nyc_subway_data %>%
  select(Line, `Station Name`, `Station Latitude`, `Station Longitude`, 
         Route1, Route2, Route3, Entry, Vending, `Entrance Type`, ADA)

# Convert the entry variable from character to a logical variable 
cleaned_data <- cleaned_data %>%
  mutate(Entry = ifelse(Entry == "YES", TRUE, FALSE))

head(cleaned_data)
```
### How many distinct stations are there? 
```{r}
dist_stations <- cleaned_data %>%
  distinct(`Station Name`, Line) %>%
  nrow()

dist_stations
```

### How many stations are ADA compliant?
```{r}
ada_stations <- cleaned_data %>%
  filter(ADA == TRUE) %>%
  distinct(`Station Name`, Line) %>%
  nrow()

ada_stations
```

### What proportion of station entrances / exits without vending allow entrance?
```{r}
no_vend <- cleaned_data %>%
  filter(Vending == "NO") %>%
  nrow() / nrow(cleaned_data)

no_vend
```

### How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?
```{r}
# Distinct stations that serve the A train
atrain_stations <- cleaned_data %>%
  filter(Route1 == "A" | Route2 == "A" | Route3 == "A") %>%
  distinct(`Station Name`, Line) %>%
  nrow()

# ADA compliant stations serving the A train
atrain_ada <- cleaned_data %>%
  filter((Route1 == "A" | Route2 == "A" | Route3 == "A") & ADA == TRUE) %>%
  distinct(`Station Name`, Line) %>%
  nrow()

atrain_stations
atrain_ada
```

The dataset contains information on `r nrow(nyc_subway_data)` observations from NYC subway entrances and exits across different stations. There are `r ncol(nyc_subway_data)` variables, primarily capturing details such as station name and line, station latitude and longitude, routes, entry permissions and vending machine availability, ADA compliance, etc.

After data cleaning, this dataset contains `r nrow(cleaned_data)` rows and `r ncol(cleaned_data)` columns.

Results: \
1. There are `r dist_stations` distinct stations based on station name and line.\
2. Out of the distinct stations, `r ada_stations` stations are ADA compliant.\
3. Approximately `r round(no_vend * 100, 2)`% of station entrances/exits without vending machines allow entry.\
4. There are `r atrain_stations` distinct stations that serve the A train. And `r atrain_ada` stations are ADA compliant in these stations. 

## Problem 2
*Mr. Trash Wheel*
```{r}
library(readxl)
library(dplyr)
library(janitor)

mr_df <- read_excel("202409 Trash Wheel Collection Data.xlsx", 
                    sheet = "Mr. Trash Wheel", range = "A2:N653") |>
  janitor::clean_names() |>
  mutate(
    trash_wheel = "Mr. Trash Wheel",  
    sports_balls = as.integer(round(sports_balls)), # Round sports balls to integer
    year = as.numeric(year)  
  )
```

*Professor Trash Wheel*
```{r}
pf_df <- read_excel("202409 Trash Wheel Collection Data.xlsx", 
                    sheet = "Professor Trash Wheel", range = "A2:M121") |>
  janitor::clean_names() |>
  mutate(
    trash_wheel = "Professor Trash Wheel" 
  )
```

*Gwynnda Trash Wheel*
```{r}
gw_df <- read_excel("202409 Trash Wheel Collection Data.xlsx", 
                                       sheet = "Gwynnda Trash Wheel", range = "A2:L265") |>
  janitor::clean_names() |>
  mutate(
    trash_wheel = "Gwynnda Trash Wheel" 
  )
```

*Combine datasets*
```{r}
combined_df <- bind_rows(mr_df, pf_df, gw_df)

head(combined_df)
```

*Clean the combined dataset again*
```{r}
 # Filter out rows without dumpster-specific data
clean_df <- combined_df |>
  filter(!is.na(dumpster))
head(clean_df)
```

### Data description

The total dataset contains information on `r nrow(clean_df)` observations from three Trash Wheels: Mr. Trash Wheel, Professor Trash Wheel, and Gwynnda Trash Wheel. The dataset has key variables such as date of collection (`date`), total weight of trash collected (`weight_tons`), and number of plastic bottles (`plastic_bottles`) and cigarette butts (`cigarette_butts`) collected.

The total weight of trash collected by Professor Trash Wheel is `r sum(clean_df |> filter(trash_wheel == "Professor Trash Wheel") |> pull(weight_tons), na.rm = TRUE)` tons. 

The total number of cigarette butts collected by Gwynnda in June of 2022 is `r sum(clean_df |> filter(trash_wheel == "Gwynnda Trash Wheel", month == "June", year == "2022") |> pull(cigarette_butts), na.rm = TRUE)`.

## Problem 3



